
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Exercise: Minari data collection &#8212; Offline Reinforcement Learning</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"loader": {"load": ["[tex]/configmacros"]}, "tex": {"packages": {"[+]": ["configmacros"]}, "macros": {"vect": ["{\\mathbf{\\boldsymbol{#1}} }", 1], "E": "{\\mathbb{E}}", "P": "{\\mathbb{P}}", "R": "{\\mathbb{R}}", "abs": ["{\\left| #1 \\right|}", 1], "simpl": ["{\\Delta^{#1} }", 1], "amax": "{\\text{argmax}}"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="application/vnd.jupyter.widget-state+json">{"state": {"00b5860b26af45a38a8038cb3eeb3427": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "0f86264530124a5e9530147669a1585d": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "description_width": ""}}, "60e19f09ffd442bcb9df4ff605347ace": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "7cfd5d486bdc4a31baf60138dc2e5127": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "DropdownModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "DropdownModel", "_options_labels": ["ObstacleTypes.obstacle_8x8_top_right", "ObstacleTypes.obst_free_8x8"], "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "DropdownView", "description": "grid obst.", "description_allow_html": false, "disabled": false, "index": 0, "layout": "IPY_MODEL_60e19f09ffd442bcb9df4ff605347ace", "style": "IPY_MODEL_0f86264530124a5e9530147669a1585d", "tabbable": null, "tooltip": null}}, "7edfdf62106b45ba99e6f5035a9888cc": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "description_width": ""}}, "86e3e115f0604919a56a0861afa5b8bc": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "DropdownModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "DropdownModel", "_options_labels": ["suboptimal_8x8", "random", "deterministic_8x8"], "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "DropdownView", "description": "grid policy", "description_allow_html": false, "disabled": false, "index": 0, "layout": "IPY_MODEL_ce9ee45c97d847f494dc11329ed24d96", "style": "IPY_MODEL_7edfdf62106b45ba99e6f5035a9888cc", "tabbable": null, "tooltip": null}}, "91e652d15fb04c9aa447e87e7ed21155": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "description_width": ""}}, "c4c7c52db4384ae081f5f0ad46859b78": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "DropdownModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "DropdownModel", "_options_labels": ["Grid_2D_8x8_discrete", "InvertedPendulum-v4", "Humanoid-v4", "AdroitHandHammer-v1", "HalfCheetah-v4"], "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "DropdownView", "description": "Mixed envs.", "description_allow_html": false, "disabled": false, "index": 0, "layout": "IPY_MODEL_00b5860b26af45a38a8038cb3eeb3427", "style": "IPY_MODEL_91e652d15fb04c9aa447e87e7ed21155", "tabbable": null, "tooltip": null}}, "ce9ee45c97d847f494dc11329ed24d96": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}}, "version_major": 2, "version_minor": 0}</script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script crossorigin="anonymous" data-jupyter-widgets-cdn="https://cdn.jsdelivr.net/npm/" src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@1.0.6/dist/embed-amd.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'nb_2_data_dollection';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Offline RL theory" href="nb_3_offline_RL_theory.html" />
    <link rel="prev" title="Open Source Datasets libraries for offline RL" href="nb_1_offline_RL_dataset_libraries.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Offline Reinforcement Learning</p>
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Offline RL Notes
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="nb_0_IntroOfflineRL.html">Introduction to Offline Reinforcement Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="nb_1_offline_RL_dataset_libraries.html">Open Source Datasets libraries for offline RL</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Exercise: Minari data collection</a></li>
<li class="toctree-l1"><a class="reference internal" href="nb_3_offline_RL_theory.html">Offline RL theory</a></li>


<li class="toctree-l1"><a class="reference internal" href="nb_4_Offline_rl_exercises.html">Exercise: Offline RL algorithms</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/nb_2_data_dollection.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Exercise: Minari data collection</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-create-the-environments">STEP 1: Create the environments</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-create-minari-datasets">STEP 2: Create Minari datasets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-feed-dataset-to-tianshou-replaybuffer">STEP 3: Feed dataset to Tianshou ReplayBuffer</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span>
<span class="o">%</span><span class="n">load_ext</span> <span class="n">autoreload</span>
<span class="o">%</span><span class="n">autoreload</span> <span class="mi">2</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="o">%</span><span class="n">load_ext</span> <span class="n">tensorboard</span>
<span class="o">%</span><span class="n">set_random_seed</span> <span class="mi">12</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># %tensorboard --logdir ../offline_rl/ --host localhost</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">offline_rl.set_env_variables</span><span class="w"> </span><span class="kn">import</span> <span class="n">set_env_variables</span>

<span class="n">set_env_variables</span><span class="p">()</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">gymnasium</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gym</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">offline_rl.custom_envs.custom_2d_grid_env.obstacles_2D_grid_register</span><span class="w"> </span><span class="kn">import</span> <span class="n">ObstacleTypes</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">offline_rl.custom_envs.custom_2d_grid_env.simple_grid</span><span class="w"> </span><span class="kn">import</span> <span class="n">Custom2DGridEnv</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">offline_rl.custom_envs.custom_envs_registration</span><span class="w"> </span><span class="kn">import</span> <span class="n">RenderMode</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">offline_rl.offline_policies.offpolicy_rendering</span><span class="w"> </span><span class="kn">import</span> <span class="n">offpolicy_rendering</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">offline_rl.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_buffer_minari</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">offline_rl.visualizations.utils</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">get_state_action_data_and_policy_grid_distributions</span><span class="p">,</span>
    <span class="n">snapshot_env</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">offline_rl.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">widget_list</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">offline_rl.custom_envs.custom_envs_registration</span><span class="w"> </span><span class="kn">import</span> <span class="n">EnvFactory</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">offline_rl.behavior_policies.behavior_policy_registry</span><span class="w"> </span><span class="kn">import</span> <span class="n">BehaviorPolicy2dGridFactory</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">offline_rl.generate_custom_minari_datasets.generate_minari_dataset</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">create_minari_datasets</span><span class="p">,</span>
<span class="p">)</span>


<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;DISPLAY&quot;</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;MUJOCO_GL&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;egl&quot;</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="c1"># To get access to the registered environments.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sys:1: DeprecationWarning: DataCollectorV0 is deprecated and will be removed. Use DataCollector instead.
</pre></div>
</div>
</div>
</div>
<section class="tex2jax_ignore mathjax_ignore" id="exercise-minari-data-collection">
<h1>Exercise: Minari data collection<a class="headerlink" href="#exercise-minari-data-collection" title="Link to this heading">#</a></h1>
<p>In this exercise you donâ€™t have any homework. The idea is to play around with it to get familiar with the code  (notebooks and source code) and with the way we collect data.</p>
<p>Remember that the pipeline for offline learning will be the following:</p>
<img src="_static/images/93_offline_RL_pipeline.png" alt="Snow" style="width:50%;">
<p>In this notebook we will be exploring the steps 1-2-3 . It would be a good idea now to give a look to the code structure:</p>
<img src="_static/images/93_code_structure.png" alt="Snow" style="width:20%;">
<p>You can also give a look to <a class="reference external" href="https://minari.farama.org/main/content/basic_usage/">Minari documentation</a> if needed.</p>
<section id="step-1-create-the-environments">
<h2>STEP 1: Create the environments<a class="headerlink" href="#step-1-create-the-environments" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># List of different environments</span>
<span class="n">ENV_LIST</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">EnvFactory</span><span class="o">.</span><span class="n">Grid_2D_8x8_discrete</span><span class="p">,</span>
    <span class="s2">&quot;InvertedPendulum-v4&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Humanoid-v4&quot;</span><span class="p">,</span>
    <span class="s2">&quot;AdroitHandHammer-v1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;HalfCheetah-v4&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="c1"># obstacles to be used with the 2d grid-world</span>
<span class="n">grid_world_obstacles</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">ObstacleTypes</span><span class="o">.</span><span class="n">obstacle_8x8_top_right</span><span class="p">,</span>
    <span class="n">ObstacleTypes</span><span class="o">.</span><span class="n">obst_free_8x8</span><span class="p">,</span>
<span class="p">]</span>

<span class="c1"># behavior policies to be used with 2d grid-world</span>
<span class="n">behavior_policy_grid_world</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">BehaviorPolicy2dGridFactory</span><span class="o">.</span><span class="n">suboptimal_8x8</span><span class="p">,</span>
    <span class="n">BehaviorPolicy2dGridFactory</span><span class="o">.</span><span class="n">random</span><span class="p">,</span>
    <span class="n">BehaviorPolicy2dGridFactory</span><span class="o">.</span><span class="n">deterministic_8x8</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_environment</span> <span class="o">=</span> <span class="n">widget_list</span><span class="p">(</span><span class="n">ENV_LIST</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Mixed envs.&quot;</span><span class="p">)</span>
<span class="n">selected_obstacle</span> <span class="o">=</span> <span class="n">widget_list</span><span class="p">(</span><span class="n">grid_world_obstacles</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;grid obst.&quot;</span><span class="p">)</span>
<span class="n">selected_grid_world_policy</span> <span class="o">=</span> <span class="n">widget_list</span><span class="p">(</span><span class="n">behavior_policy_grid_world</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;grid policy&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "c4c7c52db4384ae081f5f0ad46859b78", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "7cfd5d486bdc4a31baf60138dc2e5127", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "86e3e115f0604919a56a0861afa5b8bc", "version_major": 2, "version_minor": 0}</script></div>
</div>
<p><strong>Select and render behavior policies</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">behavior_policy</span> <span class="o">=</span> <span class="n">BehaviorPolicy2dGridFactory</span><span class="o">.</span><span class="n">random</span>
<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selected_environment</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">EnvFactory</span><span class="p">):</span>
    <span class="n">env</span> <span class="o">=</span> <span class="n">EnvFactory</span><span class="p">[</span><span class="n">selected_environment</span><span class="o">.</span><span class="n">value</span><span class="p">]</span><span class="o">.</span><span class="n">get_env</span><span class="p">(</span><span class="n">render_mode</span><span class="o">=</span><span class="n">RenderMode</span><span class="o">.</span><span class="n">RGB_ARRAY</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">unwrapped</span><span class="p">,</span> <span class="n">Custom2DGridEnv</span><span class="p">):</span>
        <span class="n">env</span><span class="o">.</span><span class="n">set_new_obstacle_map</span><span class="p">(</span><span class="n">selected_obstacle</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="n">behavior_policy</span> <span class="o">=</span> <span class="n">selected_grid_world_policy</span><span class="o">.</span><span class="n">value</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">env</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="n">selected_environment</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">render_mode</span><span class="o">=</span><span class="s2">&quot;rgb_array&quot;</span><span class="p">)</span>

<span class="n">offpolicy_rendering</span><span class="p">(</span>
    <span class="n">env_or_env_name</span><span class="o">=</span><span class="n">env</span><span class="p">,</span>
    <span class="n">render_mode</span><span class="o">=</span><span class="n">RenderMode</span><span class="o">.</span><span class="n">RGB_ARRAY</span><span class="p">,</span>
    <span class="n">behavior_policy</span><span class="o">=</span><span class="n">behavior_policy</span><span class="p">,</span>
    <span class="n">num_frames</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">fps</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="show_videos" style="border-spacing:0px;"><tr><td style="padding:1px;"><div style="display:flex; align-items:left;">
      <div style="display:flex; flex-direction:column; align-items:center;">
      <div>2d-GridWorld</div><div><video controls width="256" height="256" style="object-fit:cover;" loop autoplay muted>
      <source src="data:video/mp4;base64,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" type="video/mp4"/>
      This browser does not support the video tag.
      </video></div></div></div></td></tr></table></div></div>
</div>
</section>
<section id="step-2-create-minari-datasets">
<h2>STEP 2: Create Minari datasets<a class="headerlink" href="#step-2-create-minari-datasets" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DATA_SET_IDENTIFIER_I</span> <span class="o">=</span> <span class="s2">&quot;_collected_data_nb_92&quot;</span>
<span class="n">NUM_STEPS_I</span> <span class="o">=</span> <span class="mi">500</span>

<span class="n">data_set_config</span> <span class="o">=</span> <span class="n">create_minari_datasets</span><span class="p">(</span>
    <span class="n">env_name</span><span class="o">=</span><span class="n">env</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
    <span class="n">dataset_identifier</span><span class="o">=</span><span class="n">DATA_SET_IDENTIFIER_I</span><span class="p">,</span>
    <span class="n">num_collected_points</span><span class="o">=</span><span class="n">NUM_STEPS_I</span><span class="p">,</span>
    <span class="n">behavior_policy</span><span class="o">=</span><span class="n">behavior_policy</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Congratulations! You have created your first Minari dataset. Take a look at <code class="docutils literal notranslate"><span class="pre">src/offline_rl/data</span></code>.</strong></p>
</section>
<section id="step-3-feed-dataset-to-tianshou-replaybuffer">
<h2>STEP 3: Feed dataset to Tianshou ReplayBuffer<a class="headerlink" href="#step-3-feed-dataset-to-tianshou-replaybuffer" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">buffer_data</span> <span class="o">=</span> <span class="n">load_buffer_minari</span><span class="p">(</span><span class="n">data_set_config</span><span class="o">.</span><span class="n">data_set_name</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The number of dataset points is </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">buffer_data</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">buffer_data</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
    <span class="k">break</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dataset /workspace/src/offline_rl/data/offline_data/Grid_2D_8x8_discrete-data_collected_data_nb_92-v0 downloaded. number of episodes: 10
The number of dataset points is 500
Batch(
    obs: array([1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.]),
    act: array(1),
    rew: array(-0.01440554),
    terminated: array(False),
    truncated: array(0.),
    done: array(False),
    obs_next: array([0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0.,
                     0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                     0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                     0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.]),
    info: Batch(),
    policy: Batch(),
)
</pre></div>
</div>
</div>
</div>
<p><strong>Letâ€™s give a look to the collected 2d grid world data</strong></p>
<p><strong>Useful information:</strong></p>
<p>In our grid world environment, the agentâ€™s position is represented as <span class="math notranslate nohighlight">\((x_1, x_2)\)</span>, with <span class="math notranslate nohighlight">\(x_1/x_2\)</span> the vertical/horizontal coordinates. Observations are represented as a one-hot encoded vector of dimensions <span class="math notranslate nohighlight">\(x_1 \times x_2\)</span>, for example, a 64-dimensional vector in an 8x8 grid,</p>
<p>The action is represented by an integer in the range of [0, 1, 2, 3], each indicating a direction:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>0: (-1, 0) - UP
1: (1, 0) - DOWN
2: (0, -1) - LEFT
3: (0, 1) - RIGHT
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute state-action data distribution</span>
<span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">unwrapped</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="o">==</span> <span class="s2">&quot;Custom2DGridEnv&quot;</span><span class="p">:</span>
    <span class="n">state_action_count_data</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">get_state_action_data_and_policy_grid_distributions</span><span class="p">(</span>
        <span class="n">buffer_data</span><span class="p">,</span> <span class="n">env</span>
    <span class="p">)</span>
    <span class="n">snapshot_env</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;To analyze the data the environment should be of type </span><span class="si">{</span><span class="n">Custom2DGridEnv</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8f6d66f4181e21ead280e57f09727810f71bee0782d5928b85abb8d3bc2fdef5.png" src="_images/8f6d66f4181e21ead280e57f09727810f71bee0782d5928b85abb8d3bc2fdef5.png" />
<img alt="_images/549057e4b6d184707a8c763664b08557c199dc0f23caad1049eb6683b676d237.png" src="_images/549057e4b6d184707a8c763664b08557c199dc0f23caad1049eb6683b676d237.png" />
</div>
</div>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<p><a class="reference external" href="https://arxiv.org/abs/2004.07219"> [Fu.Justin et. al.] D4RL: Datasets for Deep Data-Driven Reinforcement Learning</a></p>
<p><a class="reference external" href="https://minari.farama.org/main/content/basic_usage/"> MINARI: A dataset API for Offline Reinforcement Learning </a></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="nb_1_offline_RL_dataset_libraries.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Open Source Datasets libraries for offline RL</p>
      </div>
    </a>
    <a class="right-next"
       href="nb_3_offline_RL_theory.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Offline RL theory</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-create-the-environments">STEP 1: Create the environments</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-create-minari-datasets">STEP 2: Create Minari datasets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-feed-dataset-to-tianshou-replaybuffer">STEP 3: Feed dataset to Tianshou ReplayBuffer</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Ivan Rodriguez
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      Â© Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>